<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…­å¤§åŒºåŸŸäººå‡GDPåˆ†å¸ƒ - å¤åˆé¥¼å›¾</title>
    
    <!-- EChartsæ ¸å¿ƒåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* å®¹å™¨åŒ…è£…ï¼Œé™åˆ¶æœ€å¤§å®½åº¦ */
        .container-wrapper {
            width: 100%;
            max-width: 1400px;
            display: flex;
            justify-content: center;
        }
        
        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 1200px;
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 16px;
            margin-bottom: 15px;
        }
        
        .instructions {
            background: #f8f9fa;
            border-radius: 8px;
            padding: 12px;
            margin: 10px 0;
            font-size: 14px;
            color: #5a6c7d;
            border-left: 4px solid #4facfe;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 15px;
        }
        
        .control-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .control-btn.secondary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        
        .control-btn.secondary:hover {
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }
        
        .chart-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }
        
        #gdpPieChart {
            flex: 1;
            min-height: 500px;
            width: 100%;
        }
        
        .stats-info {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stat-item {
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        
        .stat-value {
            font-size: 22px;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .region-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }
        
        .region-tag {
            padding: 6px 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 20px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .region-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 10px rgba(102, 126, 234, 0.3);
        }
        
        .region-tag.active {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 10px rgba(240, 147, 251, 0.3);
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: white;
            font-size: 14px;
            opacity: 0.9;
        }
        
        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .header .subtitle {
                font-size: 14px;
            }
            
            .instructions {
                font-size: 12px;
                padding: 10px;
            }
            
            .controls {
                gap: 8px;
            }
            
            .control-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .chart-container {
                padding: 15px;
            }
            
            .stats-info {
                flex-direction: column;
                align-items: center;
            }
            
            .stat-item {
                min-width: 100%;
            }
            
            .region-list {
                gap: 6px;
            }
            
            .region-tag {
                padding: 4px 10px;
                font-size: 11px;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 18px;
            }
            
            .chart-container {
                padding: 10px;
            }
            
            #gdpPieChart {
                min-height: 400px;
            }
        }
        
        @media (min-width: 1200px) {
            .container {
                max-width: 1100px;
            }
            
            .chart-container {
                min-height: 600px;
            }
        }
    </style>
</head>
<body>
    <div class="container-wrapper">
        <div class="container">
            <div class="header">
                <h1>2023å¹´ä¸­å›½å…­å¤§åŒºåŸŸ-çœä»½äººå‡GDPåˆ†å¸ƒ</h1>
                <div class="subtitle">ç‚¹å‡»åŒºåŸŸæŸ¥çœ‹çœä»½è¯¦æƒ…ï¼Œç‚¹å‡»ä»»æ„ä½ç½®è¿”å›åŒºåŸŸè§†å›¾</div>
                <div class="instructions">
                    <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong> é¥¼å›¾å±•ç¤ºäº†å…­å¤§ç»æµåŒºåŸŸçš„äººå‡GDPåˆ†å¸ƒã€‚ç‚¹å‡»ä»»ä¸€åŒºåŸŸå¯æŸ¥çœ‹è¯¥åŒºåŸŸå†…å„çœä»½çš„è¯¦ç»†æ•°æ®ï¼Œç‚¹å‡»ä»»æ„ä½ç½®è¿”å›åŒºåŸŸè§†å›¾ã€‚
                </div>
                
                <div class="region-list" id="regionList">
                    <!-- åŒºåŸŸæ ‡ç­¾å°†é€šè¿‡JavaScriptåŠ¨æ€ç”Ÿæˆ -->
                </div>
                
                <div class="controls">
                    <button class="control-btn" id="toggleLabels">
                        <i class="icon">ğŸ·ï¸</i> éšè—æ•°æ®æ ‡ç­¾
                    </button>
                    <button class="control-btn secondary" id="toggleLegend">
                        <i class="icon">ğŸ“–</i> éšè—å›¾ä¾‹
                    </button>
                    <button class="control-btn" id="resetView">
                        <i class="icon">ğŸ”„</i> é‡ç½®è§†å›¾
                    </button>
                </div>
            </div>
            
            <div class="chart-container">
                <div id="gdpPieChart"></div>
            </div>
            
            <div class="stats-info">
                <div class="stat-item">
                    <div class="stat-value" id="highestGDP">180,479</div>
                    <div class="stat-label">æœ€é«˜äººå‡GDP (å…ƒ/äºº)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="lowestGDP">52,271</div>
                    <div class="stat-label">æœ€ä½äººå‡GDP (å…ƒ/äºº)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="avgGDP">95,200</div>
                    <div class="stat-label">å…­å¤§åŒºåŸŸå¹³å‡å€¼</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">31</div>
                    <div class="stat-label">åŒ…å«çœä»½æ€»æ•°</div>
                </div>
            </div>
            
            <div class="footer">
                <p>æ•°æ®æ¥æºï¼š2023å¹´å›½å®¶ç»Ÿè®¡å±€å…¬å¼€æ•°æ®ã€å„çœä»½ç»Ÿè®¡å…¬æŠ¥ | åˆ¶å›¾ï¼šé˜®æ–‡åš | ä½¿ç”¨EChartsç»˜åˆ¶</p>
                <p>æ³¨ï¼šæ•°æ®åŒ…å«ä¸­å›½å¤§é™†31ä¸ªçœçº§è¡Œæ”¿åŒºï¼ˆä¸å«æ¸¯æ¾³å°ï¼‰</p>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–å›¾è¡¨
        var myChart = echarts.init(document.getElementById('gdpPieChart'));
        
        // åŒºåŸŸçº§æ•°æ®ï¼ˆå…­å¤§åŒºåŸŸï¼‰
        var areaData = [
            { name: 'åä¸œ', value: 118000 },
            { name: 'åå—', value: 95000 },
            { name: 'ååŒ—', value: 105000 },
            { name: 'ä¸œåŒ—', value: 63000 },
            { name: 'åä¸­', value: 72000 },
            { name: 'è¥¿éƒ¨', value: 68000 }
        ];
        
        // çœä»½çº§æ•°æ®
        var provinceData = {
            'åä¸œ': [
                { name: 'ä¸Šæµ·', value: 180479 },
                { name: 'æ±Ÿè‹', value: 144390 },
                { name: 'æµ™æ±Ÿ', value: 128820 },
                { name: 'å®‰å¾½', value: 73603 },
                { name: 'ç¦å»º', value: 126829 },
                { name: 'æ±Ÿè¥¿', value: 65567 },
                { name: 'å±±ä¸œ', value: 86056 }
            ],
            'åå—': [
                { name: 'å¹¿ä¸œ', value: 101905 },
                { name: 'å¹¿è¥¿', value: 52271 },
                { name: 'æµ·å—', value: 66717 }
            ],
            'ååŒ—': [
                { name: 'åŒ—äº¬', value: 190088 },
                { name: 'å¤©æ´¥', value: 119414 },
                { name: 'æ²³åŒ—', value: 60169 }
            ],
            'ä¸œåŒ—': [
                { name: 'è¾½å®', value: 79674 },
                { name: 'å‰æ—', value: 56199 },
                { name: 'é»‘é¾™æ±Ÿ', value: 52875 }
            ],
            'åä¸­': [
                { name: 'æ²³å—', value: 62106 },
                { name: 'æ¹–åŒ—', value: 89147 },
                { name: 'æ¹–å—', value: 73598 }
            ],
            'è¥¿éƒ¨': [
                { name: 'é‡åº†', value: 90663 },
                { name: 'å››å·', value: 67777 },
                { name: 'è´µå·', value: 52348 },
                { name: 'äº‘å—', value: 57143 },
                { name: 'é™•è¥¿', value: 82864 },
                { name: 'ç”˜è‚ƒ', value: 48120 },
                { name: 'é’æµ·', value: 63958 },
                { name: 'å®å¤', value: 72908 },
                { name: 'æ–°ç–†', value: 73618 },
                { name: 'è¥¿è—', value: 65553 }
            ]
        };
        
        // åŒºåŸŸé¢œè‰²é…ç½® - ä½¿ç”¨å’Œè°é…è‰²æ–¹æ¡ˆ
        var colorConfig = {
            'åä¸œ': {
                main: '#E8C48E', // æš–æè‰²
                sub: ['#F0D7B5', '#F2DFC4', '#F4E7D3', '#F6EFE2', '#F8F7F1', '#FAFFF0', '#FCFFF8']
            },
            'åå—': {
                main: '#8EB8E8', // æµ…è“ç°
                sub: ['#A1C4F5', '#B5D0F9', '#C9DBFC', '#DDE6FE', '#F0F5FF', '#F5F8FF', '#F8FAFF']
            },
            'ååŒ—': {
                main: '#8EE8C4', // è–„è·ç»¿
                sub: ['#A1F5D7', '#B5F9E2', '#C9FCE9', '#DDFEEF', '#F0FFF5', '#F5FFFA', '#F8FFFC']
            },
            'ä¸œåŒ—': {
                main: '#E88E8E', // è±†æ²™çº¢
                sub: ['#F5A1A1', '#F9B5B5', '#FCC9C9', '#FEDDDE', '#FFF0F0', '#FFF5F5', '#FFF8F8']
            },
            'åä¸­': {
                main: '#C48EE8', // æµ…ç´«ç°
                sub: ['#D7A1F5', '#E2B5F9', '#E9C9FC', '#EFDDFF', '#F5F0FF', '#FAF5FF', '#FCF8FF']
            },
            'è¥¿éƒ¨': {
                main: '#8EE88E', // æµ…è‰ç»¿
                sub: ['#A1F5A1', '#B5F9B5', '#C9FCC9', '#DDFEDD', '#F0FFF0', '#F5FFF5', '#F8FFF8']
            }
        };
        
        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        function calculateStats() {
            // è®¡ç®—æœ€é«˜å’Œæœ€ä½äººå‡GDP
            let allProvinces = [];
            Object.values(provinceData).forEach(provinces => {
                allProvinces = allProvinces.concat(provinces);
            });
            
            let highest = Math.max(...allProvinces.map(p => p.value));
            let lowest = Math.min(...allProvinces.map(p => p.value));
            let avg = areaData.reduce((sum, area) => sum + area.value, 0) / areaData.length;
            
            document.getElementById('highestGDP').textContent = highest.toLocaleString('zh-CN');
            document.getElementById('lowestGDP').textContent = lowest.toLocaleString('zh-CN');
            document.getElementById('avgGDP').textContent = Math.round(avg).toLocaleString('zh-CN');
        }
        
        // åŠ¨æ€è®¡ç®—å›¾è¡¨é…ç½®
        function createOption(isProvinceView, currentArea) {
            var containerWidth = document.getElementById('gdpPieChart').offsetWidth;
            var containerHeight = document.getElementById('gdpPieChart').offsetHeight;
            
            // æ ¹æ®å®¹å™¨å¤§å°åŠ¨æ€è°ƒæ•´
            var isSmallScreen = containerWidth < 768;
            var titleFontSize = Math.max(14, Math.min(20, containerWidth / 30));
            var labelFontSize = Math.max(10, Math.min(14, containerWidth / 50));
            var legendFontSize = Math.max(9, Math.min(12, containerWidth / 60));
            
            // æ ¹æ®å±å¹•å¤§å°è°ƒæ•´å›¾ä¾‹ä½ç½®å’Œé¥¼å›¾åŠå¾„
            var legendOrient = isSmallScreen ? 'horizontal' : 'vertical';
            var legendLeft = isSmallScreen ? 'center' : 10;
            var legendTop = isSmallScreen ? 'bottom' : 'middle';
            var legendBottom = isSmallScreen ? 10 : undefined;
            var legendRight = isSmallScreen ? undefined : 10;
            
            // é¥¼å›¾åŠå¾„è®¾ç½® - æ ¹æ®æ˜¯å¦ä¸ºçœä»½è§†å›¾è°ƒæ•´
            var pieRadius = isSmallScreen ? 
                (isProvinceView ? ['25%', '60%'] : ['30%', '65%']) : 
                (isProvinceView ? ['35%', '75%'] : ['30%', '70%']);
            
            // æ ‡é¢˜å’Œå‰¯æ ‡é¢˜
            var titleText = isProvinceView ? `${currentArea}çœä»½äººå‡GDPåˆ†å¸ƒ` : '2023å¹´ä¸­å›½å…­å¤§åŒºåŸŸäººå‡GDPåˆ†å¸ƒ';
            var subtext = isProvinceView ? 'ç‚¹å‡»ä»»æ„ä½ç½®è¿”å›åŒºåŸŸè§†å›¾' : 'ç‚¹å‡»åŒºåŸŸæŸ¥çœ‹çœä»½è¯¦æƒ…';
            
            // è·å–å½“å‰æ˜¾ç¤ºçš„æ•°æ®
            var displayData = isProvinceView ? provinceData[currentArea] : areaData;
            
            return {
                title: {
                    text: titleText,
                    left: 'center',
                    textStyle: { 
                        fontSize: titleFontSize, 
                        fontWeight: 'bold', 
                        color: '#2c3e50' 
                    },
                    top: 10,
                    subtext: subtext,
                    subtextStyle: { 
                        fontSize: Math.max(9, titleFontSize - 4), 
                        color: '#7f8c8d' 
                    }
                },
                tooltip: {
                    trigger: 'item',
                    formatter: function(params) {
                        var value = params.value.toLocaleString('zh-CN');
                        var percent = params.percent;
                        return `<div style="font-weight: bold; margin-bottom: 5px;">${params.name}</div>
                               <div>äººå‡GDP: <span style="color: #e74c3c; font-weight: bold">Â¥${value}</span> å…ƒ/äºº</div>
                               <div>å æ¯”: <span style="color: #3498db; font-weight: bold">${percent}%</span></div>`;
                    },
                    textStyle: { fontSize: labelFontSize },
                    backgroundColor: 'rgba(255,255,255,0.95)',
                    borderColor: '#ddd',
                    borderWidth: 1
                },
                legend: {
                    show: legendShow,
                    orient: legendOrient,
                    left: legendLeft,
                    top: legendTop,
                    bottom: legendBottom,
                    right: legendRight,
                    textStyle: { 
                        fontSize: legendFontSize, 
                        color: '#666' 
                    },
                    data: displayData.map(item => item.name),
                    itemWidth: 12,
                    itemHeight: 8,
                    itemGap: isSmallScreen ? 5 : 10,
                    backgroundColor: 'rgba(255,255,255,0.7)',
                    borderColor: '#eee',
                    borderWidth: 1,
                    borderRadius: 6,
                    padding: [10, 10]
                },
                series: [{
                    name: 'äººå‡GDP',
                    type: 'pie',
                    radius: pieRadius,
                    center: ['50%', isSmallScreen ? '45%' : '50%'],
                    data: displayData,
                    itemStyle: {
                        borderRadius: 8,
                        borderWidth: 2,
                        borderColor: '#fff',
                        shadowBlur: 5,
                        shadowColor: 'rgba(0,0,0,0.1)',
                        color: function(params) {
                            if (isProvinceView) {
                                // çœä»½è§†å›¾ï¼šä½¿ç”¨è¯¥åŒºåŸŸå­é…è‰²
                                return colorConfig[currentArea].sub[params.dataIndex % colorConfig[currentArea].sub.length];
                            } else {
                                // åŒºåŸŸè§†å›¾ï¼šä½¿ç”¨åŒºåŸŸä¸»è‰²
                                return colorConfig[params.name].main;
                            }
                        }
                    },
                    label: {
                        show: labelShow,
                        fontSize: labelFontSize,
                        color: '#555',
                        formatter: function(params) {
                            if (isSmallScreen) {
                                return params.name + ': ' + params.percent + '%';
                            } else {
                                return params.name + '\nÂ¥' + params.value.toLocaleString('zh-CN');
                            }
                        }
                    },
                    emphasis: {
                        scale: true,
                        scaleSize: 10,
                        focus: 'self',
                        itemStyle: { 
                            shadowBlur: 15, 
                            shadowColor: 'rgba(0,0,0,0.2)',
                            borderWidth: 3,
                            borderColor: '#fff'
                        }
                    },
                    avoidLabelOverlap: !isSmallScreen,
                    labelLine: {
                        length: isSmallScreen ? 10 : 15,
                        length2: isSmallScreen ? 5 : 10,
                        smooth: true
                    }
                }]
            };
        }
        
        // çŠ¶æ€å˜é‡
        var currentArea = '';
        var isProvinceView = false;
        var labelShow = true;
        var legendShow = true;
        
        // åˆå§‹åŒ–åŒºåŸŸæ ‡ç­¾
        function initRegionTags() {
            var regionList = document.getElementById('regionList');
            regionList.innerHTML = '';
            
            areaData.forEach(area => {
                var tag = document.createElement('div');
                tag.className = 'region-tag';
                if (currentArea === area.name) {
                    tag.classList.add('active');
                }
                tag.textContent = area.name;
                tag.addEventListener('click', function() {
                    currentArea = area.name;
                    isProvinceView = true;
                    updateRegionTags();
                    renderChart();
                });
                regionList.appendChild(tag);
            });
        }
        
        // æ›´æ–°åŒºåŸŸæ ‡ç­¾çŠ¶æ€
        function updateRegionTags() {
            var tags = document.querySelectorAll('.region-tag');
            tags.forEach(tag => {
                if (tag.textContent === currentArea) {
                    tag.classList.add('active');
                } else {
                    tag.classList.remove('active');
                }
            });
        }
        
        // æ¸²æŸ“å›¾è¡¨
        function renderChart() {
            myChart.setOption(createOption(isProvinceView, currentArea), true);
        }
        
        // åˆå§‹åŒ–
        calculateStats();
        initRegionTags();
        renderChart();
        
        // å›¾è¡¨ç‚¹å‡»äº‹ä»¶
        myChart.on('click', function(params) {
            // 1. æœªé€‰ä¸­åŒºåŸŸæ—¶ï¼Œç‚¹å‡»åŒºåŸŸâ†’æ˜¾ç¤ºçœä»½
            if (!isProvinceView && areaData.some(item => item.name === params.name)) {
                currentArea = params.name;
                isProvinceView = true;
                updateRegionTags();
                renderChart();
            } 
            // 2. å·²é€‰ä¸­åŒºåŸŸæ—¶ï¼Œç‚¹å‡»ä»»æ„ä½ç½®â†’è¿”å›åŒºåŸŸ
            else {
                currentArea = '';
                isProvinceView = false;
                updateRegionTags();
                renderChart();
            }
        });
        
        // æ§ä»¶åŠŸèƒ½
        document.getElementById('toggleLabels').addEventListener('click', function() {
            labelShow = !labelShow;
            this.innerHTML = labelShow ? '<i class="icon">ğŸ·ï¸</i> éšè—æ•°æ®æ ‡ç­¾' : '<i class="icon">ğŸ·ï¸</i> æ˜¾ç¤ºæ•°æ®æ ‡ç­¾';
            renderChart();
        });
        
        document.getElementById('toggleLegend').addEventListener('click', function() {
            legendShow = !legendShow;
            this.innerHTML = legendShow ? '<i class="icon">ğŸ“–</i> éšè—å›¾ä¾‹' : '<i class="icon">ğŸ“–</i> æ˜¾ç¤ºå›¾ä¾‹';
            renderChart();
        });
        
        document.getElementById('resetView').addEventListener('click', function() {
            currentArea = '';
            isProvinceView = false;
            labelShow = true;
            legendShow = true;
            document.getElementById('toggleLabels').innerHTML = '<i class="icon">ğŸ·ï¸</i> éšè—æ•°æ®æ ‡ç­¾';
            document.getElementById('toggleLegend').innerHTML = '<i class="icon">ğŸ“–</i> éšè—å›¾ä¾‹';
            updateRegionTags();
            renderChart();
        });
        
        // çª—å£è‡ªé€‚åº”
        var resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                myChart.resize();
                renderChart();
            }, 200);
        });
        
        // ç›‘å¬å®¹å™¨å¤§å°å˜åŒ–
        var chartContainer = document.getElementById('gdpPieChart');
        if (typeof ResizeObserver !== 'undefined') {
            var observer = new ResizeObserver(function() {
                myChart.resize();
                renderChart();
            });
            observer.observe(chartContainer);
        }
    </script>
</body>
</html>