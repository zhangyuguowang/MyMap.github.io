<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä¸­å›½å„çœä»½ç»æµä¸äººå£åˆ†å¸ƒä¸“é¢˜åœ°å›¾</title>
    
    <!-- EChartsæ ¸å¿ƒåº“ -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/dist/echarts.min.js"></script>
    <!-- ä¸­å›½åœ°å›¾æ•°æ® -->
    <script src="https://cdn.jsdelivr.net/npm/echarts/map/js/china.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: "Microsoft YaHei", "Segoe UI", sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        /* é™åˆ¶æœ€å¤§å®½åº¦ï¼Œé˜²æ­¢è¿‡åº¦æ‹‰ä¼¸ */
        .container-wrapper {
            width: 100%;
            max-width: 900px;
            display: flex;
            justify-content: center;
        }
        
        .container {
            flex: 1;
            display: flex;
            flex-direction: column;
            width: 100%;
            max-width: 900px; /* é™åˆ¶å®¹å™¨æœ€å¤§å®½åº¦ */
        }
        
        .header {
            text-align: center;
            margin-bottom: 20px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
        }
        
        .header h1 {
            color: #2c3e50;
            font-size: 24px;
            margin-bottom: 10px;
            font-weight: 700;
        }
        
        .header .subtitle {
            color: #7f8c8d;
            font-size: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .legend-item {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .color-box {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }
        
        .color-dot {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(45deg, #d00080, #700080);
            border: 3px solid white;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
        }
        
        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin: 15px 0;
        }
        
        .control-btn {
            padding: 8px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 5px;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
        }
        
        .control-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
        }
        
        .control-btn:active {
            transform: translateY(0);
        }
        
        .control-btn.secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            box-shadow: 0 4px 15px rgba(240, 147, 251, 0.3);
        }
        
        .control-btn.secondary:hover {
            box-shadow: 0 6px 20px rgba(240, 147, 251, 0.4);
        }
        
        .control-btn.tertiary {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            box-shadow: 0 4px 15px rgba(79, 172, 254, 0.3);
        }
        
        .control-btn.tertiary:hover {
            box-shadow: 0 6px 20px rgba(79, 172, 254, 0.4);
        }
        
        .map-container {
            flex: 1;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            display: flex;
            flex-direction: column;
        }
        
        #map {
            flex: 1;
            min-height: 500px;
            width: 100%;
        }
        
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .stat {
            text-align: center;
            flex: 1;
            min-width: 150px;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: 700;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 14px;
            color: #7f8c8d;
            margin-top: 5px;
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            padding: 15px;
            color: white;
            font-size: 14px;
            opacity: 0.9;
        }
        
        .footer a {
            color: white;
            text-decoration: none;
            border-bottom: 1px dotted white;
        }
        
        .footer a:hover {
            border-bottom: 1px solid white;
        }
        
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 20px;
            }
            
            .header .subtitle {
                font-size: 14px;
                flex-direction: column;
                gap: 10px;
            }
            
            .controls {
                gap: 8px;
            }
            
            .control-btn {
                padding: 6px 12px;
                font-size: 12px;
            }
            
            .map-container {
                padding: 15px;
            }
            
            .stats-bar {
                flex-direction: column;
                align-items: center;
            }
            
            .stat {
                min-width: 100%;
            }
        }
        
        @media (max-width: 480px) {
            .header {
                padding: 15px;
            }
            
            .header h1 {
                font-size: 18px;
            }
            
            .map-container {
                padding: 10px;
            }
        }
        
        /* æ–°å¢ï¼šå¤§å±å¹•ä¼˜åŒ– */
        @media (min-width: 1200px) {
            .container {
                max-width: 1100px;
            }
            
            .map-container {
                min-height: 600px;
            }
        }
    </style>
</head>
<body>
    <div class="container-wrapper">
        <div class="container">
            <div class="header">
                <h1>2023å¹´ä¸­å›½å„çœä»½ç»æµä¸äººå£åˆ†å¸ƒä¸“é¢˜åœ°å›¾</h1>
                <div class="subtitle">
                    <div class="legend-item">
                        <div class="color-dot"></div>
                        <span>ç´«è‰²åœ†ç‚¹ï¼šäººå‡GDPï¼ˆåœ†ç‚¹è¶Šå¤§è¡¨ç¤ºäººå‡GDPè¶Šé«˜ï¼‰</span>
                    </div>
                    <div class="legend-item">
                        <div class="color-box" style="background: linear-gradient(90deg, #0099FF, #33CC33, #FFFF00, #FF9900, #FF3333)"></div>
                        <span>é¢çŠ¶åº•è‰²ï¼šäººå£å¯†åº¦ï¼ˆé¢œè‰²è¶Šçº¢è¡¨ç¤ºäººå£å¯†åº¦è¶Šé«˜ï¼‰</span>
                    </div>
                </div>
                
                <div class="controls">
                    <button class="control-btn" id="toggleLabel">
                        <i class="icon">ğŸ—ºï¸</i> éšè—çœä»½åç§°
                    </button>
                    <button class="control-btn secondary" id="togglePoint">
                        <i class="icon">ğŸ”˜</i> éšè—äººå‡GDPåœ†ç‚¹
                    </button>
                    <button class="control-btn tertiary" id="switchLegend">
                        <i class="icon">ğŸ“Š</i> åˆ‡æ¢ï¼šæ»‘åŠ¨æ¡å›¾ä¾‹
                    </button>
                    <button class="control-btn" id="resetMap">
                        <i class="icon">ğŸ”„</i> é‡ç½®è§†å›¾
                    </button>
                </div>
            </div>
            
            <div class="map-container">
                <div id="map"></div>
            </div>
            
            <div class="stats-bar">
                <div class="stat">
                    <div class="stat-value" id="maxDensity">20,718</div>
                    <div class="stat-label">æœ€é«˜äººå£å¯†åº¦ (äºº/å¹³æ–¹å…¬é‡Œ)</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="maxGDP">483,984</div>
                    <div class="stat-label">æœ€é«˜äººå‡GDP (å…ƒ/äºº)</div>
                </div>
                <div class="stat">
                    <div class="stat-value" id="avgDensity">592</div>
                    <div class="stat-label">å¹³å‡äººå£å¯†åº¦ (äºº/å¹³æ–¹å…¬é‡Œ)</div>
                </div>
                <div class="stat">
                    <div class="stat-value">34</div>
                    <div class="stat-label">çœçº§è¡Œæ”¿åŒºæ€»æ•°</div>
                </div>
            </div>
            
            <div class="footer">
                <p>æ•°æ®æ¥æºï¼š2023å¹´ä¸­å›½ç»Ÿè®¡å¹´é‰´ | åˆ¶å›¾ï¼šé˜®æ–‡åš | ä½¿ç”¨EChartsç»˜åˆ¶</p>
                <p>æç¤ºï¼šç‚¹å‡»åœ°å›¾ä¸Šçš„çœä»½æŸ¥çœ‹è¯¦ç»†æ•°æ®ï¼Œæ‹–åŠ¨å›¾ä¾‹å¯è°ƒæ•´æ˜¾ç¤ºèŒƒå›´</p>
            </div>
        </div>
    </div>

    <script>
        // åˆå§‹åŒ–å›¾è¡¨
        var myChart = echarts.init(document.getElementById('map'));
        
        // åŸºç¡€æ•°æ®ï¼ˆåŒ…å«ç»çº¬åº¦ä¿¡æ¯ï¼‰
        var densityData = [
            { name: 'åŒ—äº¬', value: 1332.32, gdp: 200204.50, center: [116.46, 39.92] },
            { name: 'å¤©æ´¥', value: 1144.58, gdp: 122707.48, center: [117.2, 39.13] },
            { name: 'æ²³åŒ—', value: 392.11, gdp: 59440.15, center: [114.48, 38.03] },
            { name: 'å±±è¥¿', value: 221.19, gdp: 74143.84, center: [112.53, 37.87] },
            { name: 'å†…è’™å¤', value: 20.92, gdp: 102783.81, center: [111.65, 40.82] },
            { name: 'è¾½å®', value: 281.85, gdp: 72236.73, center: [123.43, 41.8] },
            { name: 'å‰æ—', value: 122.35, gdp: 57840.43, center: [125.35, 43.88] },
            { name: 'é»‘é¾™æ±Ÿ', value: 67.66, gdp: 51874.27, center: [126.63, 45.75] },
            { name: 'ä¸Šæµ·', value: 2975.83, gdp: 189823.76, center: [121.48, 31.22] },
            { name: 'æ±Ÿè‹', value: 799.81, gdp: 150389.63, center: [118.78, 32.04] },
            { name: 'æµ™æ±Ÿ', value: 628.12, gdp: 124570.70, center: [120.19, 30.26] },
            { name: 'å®‰å¾½', value: 436.78, gdp: 76867.51, center: [117.27, 31.86] },
            { name: 'ç¦å»º', value: 337.47, gdp: 129942.62, center: [119.3, 26.08] },
            { name: 'æ±Ÿè¥¿', value: 270.46, gdp: 71317.89, center: [115.85, 28.68] },
            { name: 'å±±ä¸œ', value: 641.10, gdp: 90950.58, center: [117.0, 36.65] },
            { name: 'æ²³å—', value: 592.46, gdp: 60246.96, center: [113.65, 34.76] },
            { name: 'æ¹–åŒ—', value: 313.98, gdp: 95586.90, center: [114.31, 30.52] },
            { name: 'æ¹–å—', value: 310.05, gdp: 76146.24, center: [113.0, 28.21] },
            { name: 'å¹¿ä¸œ', value: 707.24, gdp: 106778.81, center: [113.23, 23.16] },
            { name: 'å¹¿è¥¿', value: 211.57, gdp: 54112.57, center: [108.33, 22.84] },
            { name: 'æµ·å—', value: 296.56, gdp: 72384.08, center: [110.35, 20.02] },
            { name: 'é‡åº†', value: 387.43, gdp: 94458.57, center: [106.55, 29.57] },
            { name: 'å››å·', value: 172.14, gdp: 71860.54, center: [104.06, 30.67] },
            { name: 'è´µå·', value: 219.48, gdp: 54109.31, center: [106.71, 26.57] },
            { name: 'äº‘å—', value: 121.95, gdp: 64243.53, center: [102.73, 25.04] },
            { name: 'è¥¿è—', value: 3.04, gdp: 65552.60, center: [91.11, 29.97] },
            { name: 'é™•è¥¿', value: 192.20, gdp: 85491.07, center: [108.95, 34.27] },
            { name: 'ç”˜è‚ƒ', value: 57.89, gdp: 48119.64, center: [103.73, 36.03] },
            { name: 'é’æµ·', value: 8.53, gdp: 63957.91, center: [101.74, 36.56] },
            { name: 'å®å¤', value: 140.48, gdp: 72908.09, center: [106.27, 38.47] },
            { name: 'æ–°ç–†', value: 15.92, gdp: 73617.82, center: [87.68, 43.77] },
            { name: 'é¦™æ¸¯', value: 6730.79, gdp: 359117.64, center: [114.17, 22.28] },
            { name: 'æ¾³é—¨', value: 20718.18, gdp: 483984.20, center: [113.55, 22.19] },
            { name: 'å°æ¹¾', value: 647.03, gdp: 227467.53, center: [121.5, 25.03] }
        ];
        
        // è®¡ç®—ç»Ÿè®¡æ•°æ®
        function calculateStats() {
            let maxDensity = Math.max(...densityData.map(d => d.value));
            let maxGDP = Math.max(...densityData.map(d => d.gdp));
            let avgDensity = densityData.reduce((sum, d) => sum + d.value, 0) / densityData.length;
            
            document.getElementById('maxDensity').textContent = maxDensity.toLocaleString('zh-CN', { maximumFractionDigits: 0 });
            document.getElementById('maxGDP').textContent = maxGDP.toLocaleString('zh-CN', { maximumFractionDigits: 0 });
            document.getElementById('avgDensity').textContent = avgDensity.toLocaleString('zh-CN', { maximumFractionDigits: 0 });
        }
        
        // è®¡ç®—åœ†ç‚¹å¤§å°
        function getPointSize(gdpValue) {
            const containerWidth = document.getElementById('map').offsetWidth;
            // æ ¹æ®å®¹å™¨å®½åº¦è°ƒæ•´ï¼Œä½†é™åˆ¶æœ€å°å’Œæœ€å¤§å€¼
            const baseSize = Math.max(10, Math.min(30, containerWidth / 50));
            const minGdp = 48000;
            const maxGdp = 485000;
            const normalized = (gdpValue - minGdp) / (maxGdp - minGdp);
            return normalized * baseSize + 5;
        }
        
        // å‡†å¤‡æ•£ç‚¹å›¾æ•°æ®
        var pointData = densityData.map(item => ({
            name: item.name,
            value: item.center.concat([item.gdp]),
            gdp: item.gdp,
            density: item.value
        }));
        
        // å›¾ä¾‹é…ç½®
        var discreteLegend = {
            type: 'piecewise',
            seriesIndex: 0,
            pieces: [
                { min: 0, max: 100, label: '0-100äºº/å¹³æ–¹å…¬é‡Œ', color: '#0099FF' },
                { min: 101, max: 200, label: '101-200äºº/å¹³æ–¹å…¬é‡Œ', color: '#33CC33' },
                { min: 201, max: 300, label: '201-300äºº/å¹³æ–¹å…¬é‡Œ', color: '#FFFF00' },
                { min: 301, max: 600, label: '301-600äºº/å¹³æ–¹å…¬é‡Œ', color: '#FF9900' },
                { min: 601, max: 21000, label: '601+äºº/å¹³æ–¹å…¬é‡Œ', color: '#FF3333' }
            ],
            left: 20,
            bottom: 20,
            textStyle: { fontSize: 12, color: '#333' },
            orient: 'vertical',
            itemWidth: 18,
            itemHeight: 12,
            itemGap: 5,
            backgroundColor: 'rgba(255,255,255,0.8)',
            borderColor: '#ddd',
            borderWidth: 1,
            padding: [10, 10],
            borderRadius: 8
        };
        
        // ä¿®æ”¹è¿ç»­å›¾ä¾‹ï¼šä½¿ç”¨éçº¿æ€§æ˜ å°„ï¼Œè®©ä½å¯†åº¦åŒºåŸŸæ˜¾ç¤ºæ›´æ˜æ˜¾
        var continuousLegend = {
    type: 'continuous',
    seriesIndex: 0,
    min: 0,
    max: 800, // å…³é”®ä¿®æ”¹ï¼šä»21000æ”¹ä¸º800ï¼Œèšç„¦ä¸»æµæ•°æ®èŒƒå›´ï¼ˆé¿å¼€æ¾³é—¨æå€¼ï¼‰
    range: [0, 800], // åˆå§‹èŒƒå›´èšç„¦åœ¨0-800åŒºé—´ï¼Œè®©å¤§éƒ¨åˆ†çœä»½æœ‰é¢œè‰²åŒºåˆ†
    left: 20,
    bottom: 20,
    text: ['é«˜äººå£å¯†åº¦', 'ä½äººå£å¯†åº¦'],
    textStyle: { fontSize: 12, color: '#333' },
    orient: 'vertical',
    // å…³é”®ä¿®æ”¹ï¼šæ”¹ç”¨continuousæ”¯æŒçš„çº¿æ€§æ¸å˜é¢œè‰²æ•°ç»„æ ¼å¼
    inRange: {
        color: ['#0099FF', '#33CC33', '#FFFF00', '#FF9900', '#FF3333']
    },
    itemWidth: 20,
    itemHeight: 180,
    backgroundColor: 'rgba(255,255,255,0.8)',
    borderColor: '#ddd',
    borderWidth: 1,
    padding: [10, 10],
    borderRadius: 8,
    calculable: true,
    // ä¿ç•™åŸæœ‰æ ¼å¼åŒ–é€»è¾‘
    formatter: function(value) {
        if (value > 3000) {
            return 'æé«˜å¯†åº¦åŒºï¼ˆæ¸¯æ¾³ï¼‰';
        } else if (value >= 600) {
            return 'é«˜å¯†åº¦åŒº (' + Math.round(value) + 'äºº/å¹³æ–¹å…¬é‡Œ)';
        } else {
            return Math.round(value) + 'äºº/å¹³æ–¹å…¬é‡Œ';
        }
    }
};
        
        // åˆ›å»ºå›¾è¡¨é…ç½®
        var createOption = function() {
            var containerWidth = document.getElementById('map').offsetWidth;
            var containerHeight = document.getElementById('map').offsetHeight;
            
            // æ ¹æ®å®¹å™¨å®½åº¦è°ƒæ•´
            var isSmallScreen = containerWidth < 768; // è°ƒæ•´ä¸º768pxä½œä¸ºå°å±å¹•é˜ˆå€¼
            var labelFontSize = Math.max(8, Math.min(14, containerWidth / 60)); // è°ƒæ•´å­—ä½“å¤§å°è®¡ç®—
            
            // è°ƒæ•´å›¾ä¾‹ä½ç½®
            var legendConfig = isContinuousLegend ? Object.assign({}, continuousLegend) : Object.assign({}, discreteLegend);
            if (isSmallScreen) {
                legendConfig.orient = 'horizontal';
                legendConfig.left = 'center';
                legendConfig.bottom = 10;
                legendConfig.top = undefined;
                
                if (isContinuousLegend) {
                    legendConfig.itemHeight = 15;
                    legendConfig.itemWidth = Math.min(300, containerWidth * 0.8);
                }
            } else {
                // å¤§å±å¹•æ—¶å›ºå®šå›¾ä¾‹å¤§å°å’Œä½ç½®
                if (isContinuousLegend) {
                    legendConfig.itemHeight = 180;
                    legendConfig.itemWidth = 20;
                }
            }
            
            return {
                title: {
                    text: '',
                    left: 'center'
                },
                tooltip: {
                    trigger: 'item',
                    backgroundColor: 'rgba(255, 255, 255, 0.95)',
                    borderColor: '#ddd',
                    borderWidth: 1,
                    textStyle: {
                        color: '#333',
                        fontSize: 14
                    },
                    formatter: function(params) {
                        if (params.seriesType === 'map') {
                            var dataItem = densityData.find(item => item.name === params.name);
                            if (dataItem) {
                                return `<div style="font-weight: bold; margin-bottom: 5px;">${params.name}</div>
                                        <div>äººå£å¯†åº¦: <span style="color: #e74c3c; font-weight: bold">${dataItem.value.toLocaleString('zh-CN', { maximumFractionDigits: 2 })}</span> äºº/å¹³æ–¹å…¬é‡Œ</div>
                                        <div>äººå‡GDP: <span style="color: #9b59b6; font-weight: bold">Â¥${dataItem.gdp.toLocaleString('zh-CN', { maximumFractionDigits: 2 })}</span> å…ƒ</div>`;
                            }
                        } else if (params.seriesType === 'scatter') {
                            return `<div style="font-weight: bold; margin-bottom: 5px;">${params.name}</div>
                                    <div>äººå‡GDP: <span style="color: #9b59b6; font-weight: bold">Â¥${params.data.gdp.toLocaleString('zh-CN', { maximumFractionDigits: 2 })}</span> å…ƒ</div>
                                    <div>äººå£å¯†åº¦: <span style="color: #e74c3c; font-weight: bold">${params.data.density.toLocaleString('zh-CN', { maximumFractionDigits: 2 })}</span> äºº/å¹³æ–¹å…¬é‡Œ</div>`;
                        }
                        return params.name;
                    }
                },
                visualMap: legendConfig,
                geo: {
                    map: 'china',
                    roam: false,
                    label: {
                        show: labelShow,
                        fontSize: labelFontSize,
                        color: '#333',
                        fontWeight: 'bold'
                    },
                    itemStyle: {
                        normal: {
                            areaColor: '#f8f9fa',
                            borderColor: '#ddd',
                            borderWidth: 1
                        },
                        emphasis: {
                            areaColor: '#ffeaa7',
                            borderColor: '#fdcb6e',
                            borderWidth: 2
                        }
                    },
                    top: 10,
                    bottom: isSmallScreen ? (isContinuousLegend ? 50 : 40) : 50,
                    left: 10,
                    right: 10
                },
                series: [
                    {
                        name: 'äººå£å¯†åº¦',
                        type: 'map',
                        map: 'china',
                        data: densityData,
                        label: {
                            show: labelShow,
                            fontSize: labelFontSize,
                            color: '#333',
                            fontWeight: 'bold'
                        },
                        itemStyle: {
                            borderColor: '#fff',
                            borderWidth: 1
                        },
                        emphasis: {
                            itemStyle: {
                                areaColor: '#ffeaa7',
                                borderColor: '#fdcb6e',
                                borderWidth: 2
                            }
                        },
                        top: 10,
                        bottom: isSmallScreen ? (isContinuousLegend ? 50 : 40) : 50,
                        left: 10,
                        right: 10
                    },
                    {
                        name: 'äººå‡GDP',
                        type: 'scatter',
                        coordinateSystem: 'geo',
                        symbol: 'circle',
                        symbolSize: function(data) {
                            return pointShow ? getPointSize(data[2]) : 0;
                        },
                        data: pointData,
                        itemStyle: {
                            color: 'rgba(208, 0, 128, 0.8)',
                            borderColor: '#fff',
                            borderWidth: 2,
                            shadowBlur: 10,
                            shadowColor: 'rgba(208, 0, 128, 0.5)'
                        },
                        emphasis: {
                            itemStyle: {
                                color: 'rgba(112, 0, 128, 0.9)',
                                borderColor: '#fff',
                                borderWidth: 3,
                                shadowBlur: 15,
                                shadowColor: 'rgba(112, 0, 128, 0.7)'
                            }
                        },
                        zlevel: 10
                    }
                ]
            };
        };
        
        // çŠ¶æ€å˜é‡
        var labelShow = true;
        var pointShow = true;
        var isContinuousLegend = false;
        
        // åˆå§‹æ¸²æŸ“
        function renderChart() {
            myChart.setOption(createOption(), true);
        }
        
        // åˆå§‹åŒ–
        calculateStats();
        renderChart();
        
        // æ§ä»¶åŠŸèƒ½
        document.getElementById('toggleLabel').addEventListener('click', function() {
            labelShow = !labelShow;
            this.innerHTML = labelShow ? '<i class="icon">ğŸ—ºï¸</i> éšè—çœä»½åç§°' : '<i class="icon">ğŸ—ºï¸</i> æ˜¾ç¤ºçœä»½åç§°';
            renderChart();
        });
        
        document.getElementById('togglePoint').addEventListener('click', function() {
            pointShow = !pointShow;
            this.innerHTML = pointShow ? '<i class="icon">ğŸ”˜</i> éšè—äººå‡GDPåœ†ç‚¹' : '<i class="icon">ğŸ”˜</i> æ˜¾ç¤ºäººå‡GDPåœ†ç‚¹';
            renderChart();
        });
        
        document.getElementById('switchLegend').addEventListener('click', function() {
            isContinuousLegend = !isContinuousLegend;
            this.innerHTML = isContinuousLegend ? '<i class="icon">ğŸ“Š</i> åˆ‡æ¢ï¼šç¦»æ•£å›¾ä¾‹' : '<i class="icon">ğŸ“Š</i> åˆ‡æ¢ï¼šæ»‘åŠ¨æ¡å›¾ä¾‹';
            renderChart();
        });
        
        document.getElementById('resetMap').addEventListener('click', function() {
            labelShow = true;
            pointShow = true;
            isContinuousLegend = false;
            document.getElementById('toggleLabel').innerHTML = '<i class="icon">ğŸ—ºï¸</i> éšè—çœä»½åç§°';
            document.getElementById('togglePoint').innerHTML = '<i class="icon">ğŸ”˜</i> éšè—äººå‡GDPåœ†ç‚¹';
            document.getElementById('switchLegend').innerHTML = '<i class="icon">ğŸ“Š</i> åˆ‡æ¢ï¼šæ»‘åŠ¨æ¡å›¾ä¾‹';
            renderChart();
        });
        
        // çª—å£è‡ªé€‚åº”
        var resizeTimer;
        window.addEventListener('resize', function() {
            clearTimeout(resizeTimer);
            resizeTimer = setTimeout(function() {
                myChart.resize();
                renderChart();
            }, 200);
        });
        
        // ç›‘å¬å®¹å™¨å¤§å°å˜åŒ–
        var mapContainer = document.getElementById('map');
        if (typeof ResizeObserver !== 'undefined') {
            var observer = new ResizeObserver(function() {
                myChart.resize();
                renderChart();
            });
            observer.observe(mapContainer);
        }
    </script>
</body>
</html>